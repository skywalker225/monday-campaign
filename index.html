<html>
  
  <script async src="https://campaigns.apps-staging.29next.com/js/v1/campaign/"></script>
  <script>
    window.addEventListener('load', function () {
        nextCampaign.config({
            apiKey: "Ag0NqLHqBgppblJXQoBKt2P6i2NPpSth1erbndJ4",
        })
        nextCampaign.event('page_view', {
            title: document.title,
            url: window.location.href
        });
    });
</script>
  
  <button id="submitBtn">Submit Order</button>

  <label for="orderRefId">Order Ref ID:</label>
<input type="text" id="orderRefId" placeholder="Enter order_ref_id">
<button id="submitUpsellBtn">Submit Upsell</button>

  <button id="createCaret">Create Cart</button>


  <!-- Cart Create -->
  <script>
  document.getElementById('createCaret').addEventListener('click', function () {
    const payload = {
   "user": {
       "email": "monchaya+campaign@29next.com",
       "first_name": "Mon",
       "last_name": "Campaigns",
       "phone_number": "+15732020210"
    },
    "lines": [
        {
            "package_id": 22,
            "quantity": 1
        }
        ,{
            "package_id": 3,
            "quantity": 1
        }
    ],
    // "vouchers": ["SUMMER"],
    "attribution": {
        "funnel": "M funnel",
        "utm_source": "PA utm_source",
        "utm_medium": "PA utm_medium",
        "utm_campaign": "PA utm_campaign",
        "utm_term": "PA utm_term",
        "utm_content": "PA utm_content",
        "gclid": "PA gclid",
        "metadata": {
        "attribution_meta_decimal": "0.01",
        "attribution_meta_integer": "1000",
        "attribution_meta_text": "Han"
        },
        "affiliate": "PA affiliate",
        "subaffiliate1": "PA subaffiliate1",
        "subaffiliate2": "PA subaffiliate2",
        "subaffiliate3": "PA subaffiliate3",
        "subaffiliate4": "PA subaffiliate4",
        "subaffiliate5": "PA subaffiliate5",
        "agent": 1
    }
};
    fetch('https://campaigns.apps-staging.29next.com/api/v1/carts/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Ag0NqLHqBgppblJXQoBKt2P6i2NPpSth1erbndJ4' // Replace with your actual token
      },
      body: JSON.stringify(payload)
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('HTTP error ' + response.status);
      }
      return response.json();
    })
    .then(data => {
      console.log('Success:', data);
      alert('Order submitted!');
    })
    .catch(error => {
      console.error('Error:', error);
      alert('Failed to submit order.');
    });
  });
</script>

  <!-- Upsell  -->
  <script>
  document.getElementById('submitUpsellBtn').addEventListener('click', function () {
    const orderRefId = document.getElementById('orderRefId').value.trim();

    if (!orderRefId) {
      alert('Please enter a valid order_ref_id.');
      return;
    }

    const url = `https://campaigns.apps-staging.29next.com/api/v1/orders/${encodeURIComponent(orderRefId)}/upsells/`;

    const payload = {
      lines: [{ package_id: 1 }]
    };

    fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Ag0NqLHqBgppblJXQoBKt2P6i2NPpSth1erbndJ4' // Replace with your real token
      },
      body: JSON.stringify(payload)
    })
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log('Upsell success:', data);
      alert('Upsell submitted!');
    })
    .catch(error => {
      console.error('Upsell error:', error);
      alert('Failed to submit upsell.');
    });
  });
</script>

<!-- Order Create -->
<script>
  document.getElementById('submitBtn').addEventListener('click', function () {
    const payload = {
      //lines: [{ package_id: 1, quantity: 3 }],
      "lines": [
          {
              "package_id": 23,
              "quantity": 1
          }
          ,{
              "package_id": 15,
              "quantity": 2
              // ,"is_upsell": true
          }
      ],
      "currency": "USD",
      // "vouchers": ["SUMMER"],
      shipping_method: 6,
      user: {
        email: "monchaya+france@29next.com",
        first_name: "Mon",
        last_name: "Campaigns",
        phone_number: "+15732020210"
        // ip: "0.0.0.0"
      },

      // attribution: {
      //   funnel: "M funnel",
      //   utm_source: "PA utm_source",
      //   utm_medium: "PA utm_medium",
      //   utm_campaign: "PA utm_campaign",
      //   utm_term: "PA utm_term",
      //   utm_content: "PA utm_content",
      //   gclid: "PA gclid",
      //   metadata: {
      //     attribution_meta_decimal: "0.01",
      //     attribution_meta_integer: "1000",
      //     attribution_meta_text: "Han"
      //   },
      //   affiliate: "PA affiliate",
      //   subaffiliate1: "PA subaffiliate1",
      //   subaffiliate2: "PA subaffiliate2",
      //   subaffiliate3: "PA subaffiliate3",
      //   subaffiliate4: "PA subaffiliate4",
      //   subaffiliate5: "PA subaffiliate5",
      //   agent: 1
      // },
      payment_detail: {
        // payment_method: "paypal"
        payment_method: "card_token",
        card_token: "01K9VHQ3N9XWYK5R5XFEXXYFHD"
      },
      shipping_address: {
        first_name: "test",
        last_name: "test",
        country: "US",
        line1: "4389 Marigold Lane",
        state: "FL",
        postcode: "33134",
        line4: "Coral Gables",
        phone_number: "+12025550112"
      },
      // billing_address: {
      //   first_name: "test",
      //   last_name: "test",
      //   country: "US",
      //   line1: "4389 Marigold Lane",
      //   state: "FL",
      //   postcode: "33134",
      //   line4: "Coral Gables",
      //   phone_number: "+12025550112"
      // },
      billing_same_as_shipping_address: true,
      success_url: "https://webhook.site/10d5e8cb-1940-4c34-8100-f2fb33b0a671"
    };

    fetch('https://campaigns.apps-staging.29next.com/api/v1/orders/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Ag0NqLHqBgppblJXQoBKt2P6i2NPpSth1erbndJ4' // Replace with your actual token
      },
      body: JSON.stringify(payload)
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('HTTP error ' + response.status);
      }
      return response.json();
    })
    .then(data => {
      console.log('Success:', data);
      alert('Order submitted!');
    })
    .catch(error => {
      console.error('Error:', error);
      alert('Failed to submit order.');
    });
  });
</script>
</html>
